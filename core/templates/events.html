{% extends "base.html" %}
{% load static %}

{% block content %}
<!-- Events Grid -->
<section class="container mx-auto px-6 py-16 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-10">
    {% for evn in events %}
    <div class="bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden border border-gray-100">
        <div class="relative">
            <img 
                src="{{ evn.evn_img.url }}" 
                alt="{{ evn.name }}" 
                class="w-full h-56 sm:h-64 object-cover transform hover:scale-105 transition-transform duration-500"
            />
            <span class="absolute top-3 right-3 bg-blue-600 text-white px-3 py-1 rounded-full text-sm shadow-md">
                {{ evn.category.name }}
            </span>
        </div>

        <div class="p-5">
            <h2 class="text-xl font-semibold text-gray-800 mb-2 truncate">
                {{ evn.name }}
            </h2>
            <p class="text-gray-500 mb-1"><strong>Date:</strong> {{ evn.date }}</p>
            <p class="text-gray-500 mb-1"><strong>Participants:</strong> {{ evn.participant.count }}</p>

            <div class="flex justify-between mt-4 gap-2">
                <a href="{% url 'view_event' evn.id %}" 
                   class="flex-1 text-center bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg font-medium transition-all">
                   Details
                </a>

                {% if user.is_authenticated %}
                <form method="post" action="{% url 'rsvp' evn.id %}" class="flex-1">
                    {% csrf_token %}
                    <button type="submit" 
                            class="w-full bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg font-medium transition-all">
                        RSVP
                    </button>
                </form>
                {% else %}
                <a href="{% url 'sign_in' %}" 
                   class="flex-1 text-center bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg font-medium transition-all">
                   RSVP
                </a>
                {% endif %}
            </div>
        </div>
    </div>
    {% empty %}
    <div class="col-span-full text-center text-gray-600 text-lg font-medium mt-12">
        No events found at the moment 
    </div>
    {% endfor %}
</section>

<!-- Pagination -->
{% if events.paginator.num_pages > 1 %}
<div class="flex justify-center mt-10 mb-16">
    <nav class="flex space-x-2 bg-white/80 backdrop-blur-md p-3 rounded-xl shadow-md border border-blue-100">
        {% if events.has_previous %}
        <a href="?page={{ events.previous_page_number }}" 
           class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all shadow-sm">
           ‹ Prev
        </a>
        {% endif %}

        {% for num in events.paginator.page_range %}
            {% if events.number == num %}
            <span class="px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md">{{ num }}</span>
            {% elif num > events.number|add:'-3' and num < events.number|add:'3' %}
            <a href="?page={{ num }}" 
               class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-blue-100 hover:text-blue-700 transition-all shadow-sm">
               {{ num }}
            </a>
            {% endif %}
        {% endfor %}

        {% if events.has_next %}
        <a href="?page={{ events.next_page_number }}" 
           class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all shadow-sm">
           Next ›
        </a>
        {% endif %}
    </nav>
</div>
{% endif %}
{% endblock %}
